group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
head(case0201A)
plot(fitted(model), residuals(model))
abline(h = 0, col = "red", lty = 2)
hist(residuals4, main = "Histogram of Residuals", xlab = "Residuals")
qqnorm(residuals4)
qqline(residuals4, col = "red")
summary(model4)
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
head(case0201A)
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
head(case0201)
str(case0201)
summary(case0201)
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
case0201$log_Depth <- log(case0201$Depth)
case0201$sqrt_Depth <- sqrt(case0201$Depth)
case0201$Depth_squared <- case0201$Depth^2
library(tidyverse)
head(case0201)
str(case0201)
summary(case0201)
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
head(case0201A)
model2 <- lm(log_Depth ~ Year, data = case0201)
summary(model2)
residuals <- resid(model2)
shapiro_test <- shapiro.test(residuals)
shapiro_test
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
Fig3.1 <- case0201A |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)") +
theme_bw()
Fig3.1
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
head(case0201)
str(case0201)
summary(case0201)
summary(case0201)
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
case0201$log_Depth <- log(case0201$Depth)
case0201$sqrt_Depth <- sqrt(case0201$Depth)
case0201$Depth_squared <- case0201$Depth^2
case0201A <- case0201 %>%
group_by(Depth_squared) %>%
mutate(Depth_squared_Count = n())
head(case0201A)
model2 <- lm(log_Depth ~ Year, data = case0201)
summary(model2)
residuals <- resid(model2)
shapiro_test <- shapiro.test(residuals)
shapiro_test
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
model3 <- lm(sqrt_Depth ~ Year, data = case0201)
summary(model3)
residuals3 <- resid(model3)
shapiro_test3 <- shapiro.test(residuals3)
shapiro_test3
residual_distribution3 <- ggplot(data.frame(residuals3), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution3
model4 <- lm(Depth_squared ~ Year, data = case0201)
Fig3.1 <- case0201A |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)") +
theme_bw()
Fig3.1
ggplot(case0201, aes(x = Depth)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "gray", alpha = 0.7) +
facet_wrap(~ Year) +
labs(x = "Beak Depth",
y = "Frequency",
title = "Histogram of Beak Depth for 1976 and 1978") +
theme_minimal()
summary(model4)
residuals4 <- resid(model4)
shapiro_test4 <- shapiro.test(residuals4)
shapiro_test4
residual_distribution4 <- ggplot(data.frame(residuals4), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution4
hist(residuals4, main = "Histogram of Residuals", xlab = "Residuals")
qqnorm(residuals4)
qqline(residuals4, col = "red")
plot(fitted(model), residuals(model))
str(case0201)
str(case0201)
# Adding transformed variables as columns in the dataset
case0201$log_Depth <- log(case0201$Depth)
case0201$sqrt_Depth <- sqrt(case0201$Depth)
case0201$Depth_squared <- case0201$Depth^2
str(case0201)
Fig3.1 <- case0201A |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)", title = "Beak Depth in 1976 and 1978")) +
Fig3.1 <- case0201A |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)", title = "Beak Depth in 1976 and 1978") +
theme_bw()
Fig3.1
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
head(case0201)
str(case0201)
summary(case0201)
case0201
# Adding transformed variables as columns in the dataset
case0201$log_Depth <- log(case0201$Depth)
case0201$sqrt_Depth <- sqrt(case0201$Depth)
case0201$Depth_squared <- case0201$Depth^2
View(case0201)
model <- lm(Depth_squared ~ Year, data = case0201)
model2 <- lm(log_Depth ~ Year, data = case0201)
summary(model2)
# Testing normality of residuals
residuals2 <- resid(model2)
shapiro_test2 <- shapiro.test(residuals2)
shapiro_test2
# Plotting residuals for visual inspection
residual_distribution2 <- ggplot(data.frame(residuals2), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution2
# Plotting residuals for visual inspection
residual_distribution2 <- ggplot(data.frame(residuals2), aes(x= residuals2)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution2
model3 <- lm(sqrt_Depth ~ Year, data = case0201)
summary(model3)
# Testing normality of residuals
residuals3 <- resid(model3)
shapiro_test3 <- shapiro.test(residuals3)
shapiro_test3
# Plotting residuals for visual inspection
residual_distribution3 <- ggplot(data.frame(residuals3), aes(x= residuals3)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution3
# Linear model using log(Depth)
model4 <- lm(Depth ~ Year, data = case0201)
summary(model4)
# Testing normality of residuals
residuals4 <- resid(model4)
shapiro_test4 <- shapiro.test(residuals4)
shapiro_test4
# Plotting residuals for visual inspection
residual_distribution4 <- ggplot(data.frame(residuals2), aes(x= residuals4)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution4
# Plotting residuals for visual inspection
residual_distribution4 <- ggplot(data.frame(residuals2), aes(x= residuals4)) + geom_histogram(binwidth= 0.1, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution4
shapiro_test4
# Linear model using Depth
model4 <- lm(Depth ~ Year, data = case0201)
summary(model4)
# Testing normality of residuals
residuals4 <- resid(model4)
shapiro_test4 <- shapiro.test(residuals4)
shapiro_test4
# Plotting residuals for visual inspection
residual_distribution4 <- ggplot(data.frame(residuals4), aes(x= residuals4)) + geom_histogram(binwidth= 0.1, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution4
# Testing normality of residuals
residuals <- resid(model)
shapiro_test <- shapiro.test(residuals)
shapiro_test
# Plotting residuals for visual inspection
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.1, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
# Plotting residuals for visual inspection
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.3, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
# Plotting residuals for visual inspection
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.6, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
summary(model)
ggplot(case0201, aes(x = Depth)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "gray", alpha = 0.7) +
facet_wrap(~ Year) +
labs(x = "Beak Depth",
y = "Frequency",
title = "Histogram of Beak Depth for 1976 and 1978") +
theme_bw()
residuals <- resid(model)
shapiro_test <- shapiro.test(residuals)
shapiro_test
summary(model)
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.01, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
hist(residuals, main = "Histogram of Residuals", xlab = "Residuals")
qqnorm(residuals)
qqline(residuals, col = "red")
plot(fitted(model), residuals(model))
abline(h = 0, col = "red", lty = 2)
plot(model)
hist(residuals, main = "Histogram of Residuals", xlab = "Residuals")
qqnorm(residuals)
qqline(residuals, col = "red")
plot(fitted(model), residuals(model))
abline(h = 0, col = "red", lty = 2)
plot(model)
# Set up a 2x2 grid for the multipanel figure
par(mfrow = c(2, 2))
# Histogram of residuals
hist(residuals(model), main = "Histogram of Residuals", xlab = "Residuals")
# Q-Q plot with line
qqnorm(residuals(model), main = "Q-Q Plot of Residuals")
qqline(residuals(model), col = "red")
# Residuals vs. fitted values
plot(fitted(model), residuals(model),
main = "Residuals vs Fitted Values",
xlab = "Fitted Values",
ylab = "Residuals")
abline(h = 0, col = "red", lty = 2)
# Scale-Location plot
plot(model, which = 3, main = "Scale-Location Plot")
# Plotting residuals for visual inspection
residual_distribution <- ggplot(data.frame(residuals), aes(x= residuals)) + geom_histogram(binwidth= 0.6, fill= "navy", color = "black") + labs(title = "Histogram of Residuals", x= "Residuals", y= "Frequency") + theme_bw()
residual_distribution
# Testing normality of residuals
residuals <- resid(model)
shapiro_test <- shapiro.test(residuals)
shapiro_test
# Set up a 2x2 grid for the multipanel figure
par(mfrow = c(2, 2))
# Histogram of residuals
hist(residuals(model), main = "Histogram of Residuals", xlab = "Residuals")
# Q-Q plot with line
qqnorm(residuals(model), main = "Q-Q Plot of Residuals")
qqline(residuals(model), col = "red")
# Residuals vs. fitted values
plot(fitted(model), residuals(model),
main = "Residuals vs Fitted Values",
xlab = "Fitted Values",
ylab = "Residuals")
abline(h = 0, col = "red", lty = 2)
# Scale-Location plot
plot(model, which = 3, main = "Scale-Location Plot")
# Scatterplot with regression line
Figure2 <- ggplot(case0201, aes(x = Year, y = Depth_squared)) +
geom_point(alpha = 0.6, color = "blue") + # Raw data points
geom_smooth(method = "lm", color = "red", se = TRUE) + # Regression line with confidence interval
labs(title = "Relationship Between Year and Squared Beak Depth",
x = "Year",
y = "Squared Beak Depth",
caption = "Figure 2: Scatterplot with regression line highlighting the relationship between year and squared beak depth.") +
theme_minimal() # Clean theme
# Display the plot
Figure2
Figure2 <- ggplot(case0201, aes(x = as.factor(Year), y = Depth_squared)) +
geom_boxplot(outlier.color = "red", fill = "lightblue", alpha = 0.6) + # Box plot
geom_jitter(width = 0.2, alpha = 0.6, color = "blue") + # Overlaid raw data points
labs(title = "Distribution of Squared Beak Depth by Year",
x = "Year",
y = "Squared Beak Depth",
caption = "Figure 2: Box plot showing the distribution of squared beak depth by year, with overlaid raw data points.") +
theme_minimal() # Clean theme
# Display the plot
Figure2
# Box plot with regression line
Figure2 <- ggplot(case0201, aes(x = as.factor(Year), y = Depth_squared)) +
# Box plot
geom_boxplot(outlier.color = "red", fill = "lightblue", alpha = 0.6) +
# Raw data points
geom_jitter(width = 0.2, alpha = 0.6, color = "blue") +
# Regression line
stat_summary(aes(group = 1),
fun = mean,
geom = "line",
color = "red",
size = 1) +
stat_summary(aes(group = 1),
fun = mean,
geom = "point",
color = "red",
size = 2) +
# Annotations
labs(title = "Distribution of Squared Beak Depth by Year with Model Fit",
x = "Year",
y = "Squared Beak Depth",
caption = "Figure 2: Box plot showing the distribution of squared beak depth by year with overlaid model fit (red line). Raw data points are jittered for clarity.") +
theme_minimal()
# Display the plot
Figure2
summary(case0201)
head(case0201)
str(case0201)
library(knitr)
install.packages("kableExtra")
library(kableExtra)
library(knitr)
library(kableExtra)
library(dplyr)
# Summary table creation
summary_table <- case0201 %>%
summarise(
`Minimum Beak Depth (mm)` = min(Depth),
`Maximum Beak Depth (mm)` = max(Depth),
`Mean Beak Depth (1976, mm)` = mean(Depth[Year == 1976]),
`Mean Beak Depth (1978, mm)` = mean(Depth[Year == 1978]),
`Mean Beak Depth Squared (1976, mm²)` = mean(Depth_squared[Year == 1976]),
`Mean Beak Depth Squared (1978, mm²)` = mean(Depth_squared[Year == 1978])
) %>%
t() %>%  # Transpose for readability
as.data.frame()
# Add row names as a column for labeling
summary_table <- tibble::rownames_to_column(summary_table, "Metric")
colnames(summary_table) <- c("Metric", "Value")
# Create a formatted table for presentation
summary_table %>%
kbl(caption = "Table 1: Key Features of Finch Beak Depth Data") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)
summary_table %>%
kbl(caption = "Table 1: Key Features of Finch Beak Depth Data")
# Creating the summary table
summary_table %>%
kbl(caption = "Table 1: Key Features of Finch Beak Depth Data") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)
Fig1 <- case0201A |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)", title = "Beak Depth in 1976 and 1978") +
theme_bw()
Fig1 <- case0201 |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)", title = "Beak Depth in 1976 and 1978") +
theme_bw()
Fig1
Fig2 <-ggplot(case0201, aes(x = Depth)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "gray", alpha = 0.7) +
facet_wrap(~ Year) +
labs(x = "Beak Depth",
y = "Frequency",
title = "Histogram of Beak Depth for 1976 and 1978") +
theme_bw()
Fig2
# Set up a 2x2 grid for the multipanel figure
par(mfrow = c(2, 2))
# Histogram of residuals
hist(residuals(model), main = "Histogram of Residuals", xlab = "Residuals")
# Q-Q plot with line
qqnorm(residuals(model), main = "Q-Q Plot of Residuals")
qqline(residuals(model), col = "red")
# Residuals vs. fitted values
plot(fitted(model), residuals(model),
main = "Residuals vs Fitted Values",
xlab = "Fitted Values",
ylab = "Residuals")
abline(h = 0, col = "red", lty = 2)
# Scale-Location plot
plot(model, which = 3, main = "Scale-Location Plot")
head(case0201)
str(case0201)
summary(case0201)
head(case0201)
str(case0201)
summary(case0201)
head(case0201)
str(case0201)
summary(case0201)
shapiro_test2
shapiro_test3
shapiro_test4
summary(model)
library(broom)
library(broom)
model_table <- tidy(model)
model_table
summary(model)
model_table <- tidy(model)
model_table
# Extract components from the summary(model) output
model_summary <- summary(model)
# Create a dataframe to include coefficients
coefficients_table <- as.data.frame(model_summary$coefficients)
coefficients_table <- tibble::rownames_to_column(coefficients_table, "Term") # Add row names as a column
# Add model fit statistics
fit_statistics <- data.frame(
Metric = c("R-squared", "Adjusted R-squared", "Residual Standard Error", "F-statistic"),
Value = c(
model_summary$r.squared,
model_summary$adj.r.squared,
model_summary$sigma,
model_summary$fstatistic[1]
)
)
# Combine coefficients and fit statistics into one table
model_table <- list(
"Coefficients" = coefficients_table,
"Model Fit Statistics" = fit_statistics
)
# Print the table
model_table
# Combine coefficients and fit statistics into one table
lr_table <- list(
"Coefficients" = coefficients_table,
"Model Fit Statistics" = fit_statistics
)
# Print the table
lr_table
summary(model)
# Linear model using log(Depth)
model2 <- lm(log_Depth ~ Year, data = case0201)
summary(model2)
# Testing normality of residuals
residuals2 <- resid(model2)
shapiro_test2 <- shapiro.test(residuals2)
shapiro_test2
# Summary table creation
summary_table <- case0201 %>%
summarise(
`Minimum Beak Depth (mm)` = min(Depth),
`Maximum Beak Depth (mm)` = max(Depth),
`Mean Beak Depth (1976, mm)` = mean(Depth[Year == 1976]),
`Mean Beak Depth (1978, mm)` = mean(Depth[Year == 1978]),
`Mean Beak Depth Squared (1976, mm²)` = mean(Depth_squared[Year == 1976]),
`Mean Beak Depth Squared (1978, mm²)` = mean(Depth_squared[Year == 1978])
) %>%
t() %>%  # Transposes the table so that metrics are rows
as.data.frame()
# Converting the row names of the summary_table dataframe into a new column named "Metric"
summary_table <- tibble::rownames_to_column(summary_table, "Metric")
colnames(summary_table) <- c("Metric", "Value")
# Creating the summary table
summary_table %>%
kbl(caption = "Table 1: Key Features of Finch Beak Depth Data") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)
Fig1 <- case0201 |>
ggplot() +
geom_boxplot(aes(x = as.factor(Year), y = Depth)) +
geom_jitter(aes(x = as.factor(Year), y = Depth), width = 0.2, alpha = 0.6, color = "turquoise") + # Add jittered points
labs(x = "Year", y = "Depth (mm)", title = "Beak Depth in 1976 and 1978") +
theme_bw()
Fig1
Fig2 <-ggplot(case0201, aes(x = Depth)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "gray", alpha = 0.7) +
facet_wrap(~ Year) +
labs(x = "Beak Depth",
y = "Frequency",
title = "Histogram of Beak Depth for 1976 and 1978") +
theme_bw()
Fig2
# Testing normality of residuals
residuals <- resid(model)
shapiro_test <- shapiro.test(residuals)
shapiro_test
# Set up a 2x2 grid for the multipanel figure
par(mfrow = c(2, 2))
# Histogram of residuals
hist(residuals(model), main = "Histogram of Residuals", xlab = "Residuals")
# Q-Q plot with line
qqnorm(residuals(model), main = "Q-Q Plot of Residuals")
qqline(residuals(model), col = "red")
# Residuals vs. fitted values
plot(fitted(model), residuals(model),
main = "Residuals vs Fitted Values",
xlab = "Fitted Values",
ylab = "Residuals")
abline(h = 0, col = "red", lty = 2)
# Scale-Location plot
plot(model, which = 3, main = "Scale-Location Plot")
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
library(knitr)
library(kableExtra)
library(dplyr)
library(ggplot2)
library(SemiPar)
library(tidyr)
library(tidyverse)
library(Sleuth3)
library(knitr)
library(kableExtra)
library(dplyr)
